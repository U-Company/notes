# Что в примере

Клиентская программа ***client.py*** посылает запрос к **сервису 1**. В зависимости от переданного
параметра **сервис 1** может сразу же вернуть ответ, либо обратиться к **сервису 2** и вернуть ответ после ответа
**сервиса 2**. 

# Как запустить
## Настройка окружения

Для настройки окружения следует перейти в папку ***./opentelemetry/fastapi*** активировать виртуальное окружение и выполнить команду:
> make deps


## Запуск примера FastAPi

Параметры запуска задаются в конфигурационном файле ***.env***.  
Параметры:  
jaeger_host=localhost  - адрес хоста на котором запущен **Jaeger**.  
server1_port=8081    - адрес порта **сервиса 1**.  
server2_port=8082    - адрес порта **сервиса 2**.  

Для просмотра трэйсов должен быть запущен **Jaeger**.  

 1. Запустить **сервис 1**:  
     > python server_fa1.py  
 2.  Запустить **сервис 2**:   
     > python server_fa2.py  
 3.  Запустить **клиента**:   
     > python client.py \<param\>

Параметры запуска **клиента**:  
  - ***testing*** - клиент обращается к ***сервису 1***, ***сервис 1*** 
сразу же возвращает ответ;  
  -  ***test*** - клиент обращается к ***сервису 1***, ***сервис 1*** 
перенаправляет запрос к ***сервису 2***, ***сервис 2*** возвращает нормальный ответ;  
  -  ***test_error*** - клиент обращается к ***сервису 1***, ***сервис 1*** 
перенаправляет запрос к ***сервису 2***, ***сервис 2*** возвращает ошибку;  